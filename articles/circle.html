<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started • circle</title>
<!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">circle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="active nav-item"><a class="nav-link" href="../articles/circle.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/circle/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/circle/blob/HEAD/vignettes/circle.Rmd" class="external-link"><code>vignettes/circle.Rmd</code></a></small>
      <div class="d-none name"><code>circle.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To be able to run builds from a repository, it needs to be enabled on
Circle CI first. This package heavily relies on GitHub for automatic
user information extraction and other providers such as GitLab or
Bitbucket are not supported. In general Circle CI builds can be run from
any Git hosting provider.</p>
</div>
<div class="section level2">
<h2 id="authentication-with-github">Authentication with GitHub<a class="anchor" aria-label="anchor" href="#authentication-with-github"></a>
</h2>
<p>To get started with Circle CI on GitHub, make sure to install the <a href="https://GitHub.com/marketplace/circleci" class="external-link">Circle CI GitHub App</a>
and configure the “Free” plan for your account.</p>
<p>The first time any {circle} function is called, it will check for the
existence of a Circle API key. This API key is needed to securely talk
to the Circle CI API and make requests on behalf of a user. There are
two ways the API key can be set:</p>
<ul>
<li>(<strong>recommended</strong>) Via environment variable
<code>R_CIRCLE</code> in <code>~/.Renviron</code>
(e.g. <code>R_CIRCLE = &lt;API KEY&gt;</code>)</li>
<li>In <code>~/.circleci/cli.yml</code> via the following pattern</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">host</span><span class="kw">:</span><span class="at"> https://circleci.com</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">endpoint</span><span class="kw">:</span><span class="at"> graphql-unstable</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">token</span><span class="kw">:</span><span class="at"> &lt;token&gt;</span></span></code></pre></div>
<p>To create an API key from the R console,
<code><a href="../reference/browse_circle_token.html">browse_circle_token()</a></code> can be used.</p>
<p>{circle} scrapes information about the current repository by making
API calls to GitHub. To be able to do this, a <code>GitHub_TOKEN</code>
is needed (similar to the API requests for Circle CI). It is good
practice to have such a token set for many purposes when using R with
GitHub. Invoking <code><a href="https://usethis.r-lib.org/reference/github-token.html" class="external-link">usethis::create_github_token()</a></code> is an easy
way to create one if none exists yet.</p>
</div>
<div class="section level2">
<h2 id="first-steps">First steps<a class="anchor" aria-label="anchor" href="#first-steps"></a>
</h2>
<p>By querying information about the user and enabling a project one can
check if everything was set up correctly.</p>
<p><code><a href="../reference/get_circle_user.html">get_circle_user()</a></code> makes uses of the Circle CI API
key.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">circle</span><span class="fu">::</span><span class="fu"><a href="../reference/get_circle_user.html">get_circle_user</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Example output:</p>
<pre><code>$content
$content$name
[1] "Patrick Schratz"

$content$login
[1] "pat-s"

$content$id
[1] "9c373331-d0f7-45e1-afe6-4a5c75e00d10"

$path
[1] "/me"

$response
Response [https://circleci.com/api/v2/me?circle-token=***]
  Date: 2021-01-07 20:07
  Status: 200
  Content-Type: application/json;charset=utf-8
  Size: 86 B

attr(,"class")
[1] "circle_user"</code></pre>
<p><code><a href="../reference/enable_repo.html">enable_repo()</a></code> also uses the GitHub token.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">circle</span><span class="fu">::</span><span class="fu"><a href="../reference/enable_repo.html">enable_repo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>After the repo has been enabled, it should be returned in
<code><a href="../reference/list_projects.html">circle::list_projects()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="deployment">Deployment<a class="anchor" aria-label="anchor" href="#deployment"></a>
</h2>
<p>Deployments refers to the practice to push (modified) files during a
build to a repository. Configuring build deployments can be a bit
tedious with respect to permissions. Here
<code><a href="../reference/use_circle_deploy.html">circle::use_circle_deploy()</a></code> helps as it creates a SSH key
pair which will enable deployment. The private key will be stored in
GitHub (under “Settings -&gt; SSH and GPG keys”) and the public key on
Circle CI (on the respective project page in “SSH Keys”).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">circle</span><span class="fu">::</span><span class="fu"><a href="../reference/use_circle_deploy.html">use_circle_deploy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Example output:</p>
<pre><code>✖ No 'user-key' found.
✔ Added a 'user key' to project '&lt;repo-slug&gt;' on Circle CI.
This enables deployment from builds.</code></pre>
<p>To double-check, there should now be a “user-key” in your Circle CI
repo settings under the menu point “SSH keys”. It does not matter if
multiple “deploy key” or “user-key”s exists. The important point is that
one “user key” is set as “preferred”.</p>
<p>As an alternative to <code><a href="../reference/use_circle_deploy.html">circle::use_circle_deploy()</a></code> one
could also click the “Add user key” button that would appear if no user
key has been set yet.</p>
<div class="section level3">
<h3 id="deployment-keys">Deployment Keys<a class="anchor" aria-label="anchor" href="#deployment-keys"></a>
</h3>
<p>With respect to SSH keys, there two different types of keys on Circle
CI:</p>
<ul>
<li><p>Deploy key</p></li>
<li><p>User key</p></li>
</ul>
<p>“Deploy keys” are used to checkout your repository so that the build
is starting. These kind of keys how only “read” permissions but are not
allow to “write” to your repository. If you have connected Circle CI to
GitHub already, you will have a “deploy key” stored in every repository
to be able to checkout the code. The name “deploy” key here is a bit
misleading since they <strong>cannot</strong> be used for deploying from
builds.</p>
<p>To enable deployment to a repository however, a “user-key” is needed.
This key type also has “write” permissions and can be added using
<code><a href="../reference/use_circle_deploy.html">use_circle_deploy()</a></code>. <code><a href="../reference/use_circle_deploy.html">use_circle_deploy()</a></code> will
add a so called “user key” to the settings of the repo on Circle CI. The
private key will be added to your GitHub profile under the “SSH and GPG
keys” section with the title pointing to the respective repo. See also
<a href="https://circleci.com/docs/guides/deploy/deployment-overview//" class="external-link">the
Circle CI section about deployment</a>.</p>
<p>(If for some reasons you do not want to use
<code><a href="../reference/use_circle_deploy.html">use_circle_deploy()</a></code> and go the manual way of adding a SSH
key to Circle CI, please be aware of <a href="https://discuss.circleci.com/t/adding-ssh-keys-fails/7747" class="external-link">this
issue</a>.)</p>
</div>
</div>
<div class="section level2">
<h2 id="starting-a-build">Starting a Build<a class="anchor" aria-label="anchor" href="#starting-a-build"></a>
</h2>
<p>As with almost every CI provider, a YAML configuration files is
required to specify the tasks that should be executed during a build.
Currently Circle CI does not come with official support for the R
language but you can add <a href="https://ideas.circleci.com/cloud-feature-requests/p/add-official-support-for-r" class="external-link">your
vote here</a>. Since Circle CI is heavily based on docker this is not
really a problem. One can simply use the <a href="https://github.com/rocker-org/rocker" class="external-link">rocker</a> R images to have
first-class support with respect to R containers. Official support for R
would mean that the images are cached on Circle CIs side and be directly
available on build start. Currently, <code>rocker</code> images need to
be downloaded in every build again.</p>
<p>{circle} does not come with a template for running R builds as it
focuses on API and build metadata functionality. Instead, have a look at
<a href="https://docs.ropensci.org/tic/" class="external-link">ropensci/tic</a> and its
functions <code><a href="https://docs.ropensci.org/tic/reference/use_tic.html" class="external-link">tic::use_tic()</a></code> and
<code><a href="https://docs.ropensci.org/tic/reference/yaml_templates.html" class="external-link">tic::use_circle_yml()</a></code> to quickly get R builds running on
Circle CI. Alternatively you can borrow the config that is being used <a href="https://github.com/ropensci/circle/blob/main/.circleci/config.yml" class="external-link">in
this repo</a> - which was also created via {tic}.</p>
</div>
<div class="section level2">
<h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>Using {circle} with {tic}: <a href="https://docs.ropensci.org/circle/articles/tic.html" class="external-link uri">https://docs.ropensci.org/circle/articles/tic.html</a>
</li>
<li>Advanced usage and {tic} integration: <a href="https://docs.ropensci.org/circle/articles/advanced.html" class="external-link uri">https://docs.ropensci.org/circle/articles/advanced.html</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>





  </body>
</html>
